#!/usr/bin/env node

var argv = require('minimist')(process.argv.slice(2));
var nb = require('../')(argv);
var debug = require('debug')('benchmark:nb');

// create all ioc instances
nb.on('all connected', function(){
  debug('all connected, ready to emit!');

  nb.broadcast('hi baywalk');
});

nb.on('exit', function(){
  debug('Quit node benchmark process!');
  process.exit(0);
});

// hook `Ctrl + C`
process.on('SIGINT', function () {
  debug("Stoping workers elegantly...");

  nb.stop();
});

// start benchmarkding
nb.run();
